{"ast":null,"code":"import { _ as _classPrivateMethodInitSpec, a as _classPrivateMethodGet } from '../../../../dist/classPrivateMethodGet-9d546189.browser.esm.js';\nimport { _ as _defineProperty } from '../../../../dist/defineProperty-c8ecdc07.browser.esm.js';\nimport { _ as _classPrivateFieldInitSpec, a as _classPrivateFieldSet, b as _classPrivateFieldGet } from '../../../../dist/classPrivateFieldSet-eea39a9a.browser.esm.js';\nimport { W as WagmiAdapter } from '../../../../dist/tw-connector-443c384d.browser.esm.js';\nimport { a as AbstractBrowserWallet } from '../../../../dist/base-26952412.browser.esm.js';\nimport '../../../../dist/checkPrivateRedeclaration-3aaaa21d.browser.esm.js';\nimport 'eventemitter3';\nimport '../../abstract/dist/thirdweb-dev-wallets-evm-wallets-abstract.browser.esm.js';\nimport 'ethers';\nimport '@thirdweb-dev/chains';\nconst TW_WC_PROJECT_ID = \"145769e410f16970a79ff77b2d89a1e0\";\n\nvar _walletConnectConnector = /*#__PURE__*/new WeakMap();\n\nvar _provider = /*#__PURE__*/new WeakMap();\n\nvar _maybeThrowError = /*#__PURE__*/new WeakMap();\n\nvar _onConnect = /*#__PURE__*/new WeakMap();\n\nvar _onDisconnect = /*#__PURE__*/new WeakMap();\n\nvar _onChange = /*#__PURE__*/new WeakMap();\n\nvar _onMessage = /*#__PURE__*/new WeakMap();\n\nvar _onSessionRequestSent = /*#__PURE__*/new WeakMap();\n\nvar _setupListeners = /*#__PURE__*/new WeakSet();\n\nvar _removeListeners = /*#__PURE__*/new WeakSet();\n\nclass WalletConnect extends AbstractBrowserWallet {\n  get walletName() {\n    return \"WalletConnect\";\n  }\n\n  constructor(options) {\n    super(options?.walletId || WalletConnect.id, options);\n\n    _classPrivateMethodInitSpec(this, _removeListeners);\n\n    _classPrivateMethodInitSpec(this, _setupListeners);\n\n    _classPrivateFieldInitSpec(this, _walletConnectConnector, {\n      writable: true,\n      value: void 0\n    });\n\n    _classPrivateFieldInitSpec(this, _provider, {\n      writable: true,\n      value: void 0\n    });\n\n    _defineProperty(this, \"connector\", void 0);\n\n    _defineProperty(this, \"projectId\", void 0);\n\n    _defineProperty(this, \"qrcode\", void 0);\n\n    _classPrivateFieldInitSpec(this, _maybeThrowError, {\n      writable: true,\n      value: error => {\n        if (error) {\n          throw error;\n        }\n      }\n    });\n\n    _classPrivateFieldInitSpec(this, _onConnect, {\n      writable: true,\n      value: data => {\n        _classPrivateFieldSet(this, _provider, data.provider);\n\n        if (!_classPrivateFieldGet(this, _provider)) {\n          throw new Error(\"WalletConnect provider not found after connecting.\");\n        }\n      }\n    });\n\n    _classPrivateFieldInitSpec(this, _onDisconnect, {\n      writable: true,\n      value: () => {\n        _classPrivateMethodGet(this, _removeListeners, _removeListeners2).call(this);\n      }\n    });\n\n    _classPrivateFieldInitSpec(this, _onChange, {\n      writable: true,\n      value: async payload => {\n        if (payload.chain) ;else if (payload.account) ;\n      }\n    });\n\n    _classPrivateFieldInitSpec(this, _onMessage, {\n      writable: true,\n      value: payload => {\n        switch (payload.type) {\n          case \"display_uri\":\n            this.emit(\"open_wallet\", payload.data);\n            break;\n        }\n      }\n    });\n\n    _classPrivateFieldInitSpec(this, _onSessionRequestSent, {\n      writable: true,\n      value: () => {\n        // open wallet after request is sent\n        this.emit(\"open_wallet\");\n      }\n    });\n\n    this.projectId = options?.projectId || TW_WC_PROJECT_ID;\n    this.qrcode = options?.qrcode === false ? false : true;\n  }\n\n  async getConnector() {\n    if (!this.connector) {\n      // import the connector dynamically\n      const {\n        WalletConnectConnector\n      } = await import('../../../connectors/wallet-connect/dist/thirdweb-dev-wallets-evm-connectors-wallet-connect.browser.esm.js');\n\n      _classPrivateFieldSet(this, _walletConnectConnector, new WalletConnectConnector({\n        chains: this.chains,\n        options: {\n          qrcode: this.qrcode,\n          projectId: this.projectId,\n          dappMetadata: this.dappMetadata,\n          storage: this.walletStorage\n        }\n      }));\n\n      this.connector = new WagmiAdapter(_classPrivateFieldGet(this, _walletConnectConnector));\n\n      _classPrivateFieldSet(this, _provider, await _classPrivateFieldGet(this, _walletConnectConnector).getProvider());\n\n      _classPrivateMethodGet(this, _setupListeners, _setupListeners2).call(this);\n    }\n\n    return this.connector;\n  }\n\n}\n\nfunction _setupListeners2() {\n  if (!_classPrivateFieldGet(this, _walletConnectConnector)) {\n    return;\n  }\n\n  _classPrivateMethodGet(this, _removeListeners, _removeListeners2).call(this);\n\n  _classPrivateFieldGet(this, _walletConnectConnector).on(\"connect\", _classPrivateFieldGet(this, _onConnect));\n\n  _classPrivateFieldGet(this, _walletConnectConnector).on(\"disconnect\", _classPrivateFieldGet(this, _onDisconnect));\n\n  _classPrivateFieldGet(this, _walletConnectConnector).on(\"change\", _classPrivateFieldGet(this, _onChange));\n\n  _classPrivateFieldGet(this, _walletConnectConnector).on(\"message\", _classPrivateFieldGet(this, _onMessage));\n\n  _classPrivateFieldGet(this, _provider)?.signer.client.on(\"session_request_sent\", _classPrivateFieldGet(this, _onSessionRequestSent));\n}\n\nfunction _removeListeners2() {\n  if (!_classPrivateFieldGet(this, _walletConnectConnector)) {\n    return;\n  }\n\n  _classPrivateFieldGet(this, _walletConnectConnector).removeListener(\"connect\", _classPrivateFieldGet(this, _onConnect));\n\n  _classPrivateFieldGet(this, _walletConnectConnector).removeListener(\"disconnect\", _classPrivateFieldGet(this, _onDisconnect));\n\n  _classPrivateFieldGet(this, _walletConnectConnector).removeListener(\"change\", _classPrivateFieldGet(this, _onChange));\n\n  _classPrivateFieldGet(this, _walletConnectConnector).removeListener(\"message\", _classPrivateFieldGet(this, _onMessage));\n\n  _classPrivateFieldGet(this, _provider)?.signer.client.removeListener(\"session_request_sent\", _classPrivateFieldGet(this, _onSessionRequestSent));\n}\n\n_defineProperty(WalletConnect, \"id\", \"walletConnect\");\n\n_defineProperty(WalletConnect, \"meta\", {\n  name: \"Wallet Connect\",\n  iconURL: \"ipfs://QmX58KPRaTC9JYZ7KriuBzeoEaV2P9eZcA3qbFnTHZazKw/wallet-connect.svg\"\n});\n\nexport { WalletConnect };","map":null,"metadata":{},"sourceType":"module"}