{"ast":null,"code":"'use strict';\n\nconst CID = require('cids');\n\nconst util = require('./util');\n/**\n * Resolves a path within a PB block.\n *\n * If the path resolves half-way to a link, then the `remainderPath` is the part\n * after the link that can be used for further resolving\n *\n * Returns the value or a link and the partial missing path. This way the\n * IPLD Resolver can fetch the link and continue to resolve.\n *\n * @param {Uint8Array} binaryBlob - Binary representation of a PB block\n * @param {string} [path='/'] - Path that should be resolved\n */\n\n\nexports.resolve = function (binaryBlob) {\n  let path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '/';\n  let node = util.deserialize(binaryBlob);\n  const parts = path.split('/').filter(Boolean);\n\n  while (parts.length) {\n    const key = parts.shift(); // @ts-ignore\n\n    if (node[key] === undefined) {\n      // There might be a matching named link\n      for (const link of node.Links) {\n        if (link.Name === key) {\n          return {\n            value: link.Hash,\n            remainderPath: parts.join('/')\n          };\n        }\n      } // There wasn't even a matching named link\n\n\n      throw new Error(`Object has no property '${key}'`);\n    } // @ts-ignore\n\n\n    node = node[key];\n\n    if (CID.isCID(node)) {\n      return {\n        value: node,\n        remainderPath: parts.join('/')\n      };\n    }\n  }\n\n  return {\n    value: node,\n    remainderPath: ''\n  };\n};\n/**\n * Return all available paths of a block.\n *\n * @generator\n * @param {Uint8Array} binaryBlob - Binary representation of a PB block\n * @yields {string} - A single path\n */\n\n\nexports.tree = function* (binaryBlob) {\n  const node = util.deserialize(binaryBlob); // There is always a `Data` and `Links` property\n\n  yield 'Data';\n  yield 'Links';\n\n  for (let ii = 0; ii < node.Links.length; ii++) {\n    yield `Links/${ii}`;\n    yield `Links/${ii}/Name`;\n    yield `Links/${ii}/Tsize`;\n    yield `Links/${ii}/Hash`;\n  }\n};","map":null,"metadata":{},"sourceType":"script"}